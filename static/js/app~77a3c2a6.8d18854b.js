"use strict";(self["webpackChunkhard_diancan_front"]=self["webpackChunkhard_diancan_front"]||[]).push([[242],{92058:function(e,t,a){a.d(t,{A:function(){return p}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ai-settings-container"},[e._m(0),t("AdminDashboard",{attrs:{systemPrompt:e.systemPrompt,isOnline:e.isOnline,isScanning:e.isScanning,language:e.language,knowledgeBase:e.knowledgeBase,posts:e.posts,deletedPosts:e.deletedPosts,aiConfig:e.aiConfig},on:{"update:aiConfig":e.handleUpdateAiConfig,setOnline:e.handleSetOnline,addKnowledge:e.handleAddKnowledge,editKnowledge:e.handleEditKnowledge,removeKnowledge:e.handleRemoveKnowledge,runModerationScan:e.handleRunModerationScan,"update:systemPrompt":e.handleUpdateSystemPrompt,"update:language":e.handleUpdateLanguage,updatePosts:e.handleUpdatePosts}})],1)},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-header"},[t("h2",[e._v("AI 设置管理")]),t("p",[e._v("配置 AI 服务、管理知识库和审核系统")])])}],r=(a(44114),a(98992),a(54520),a(18962)),o=a(36197),l=a(24492),n=a(69154),c={name:"AiSettings",components:{AdminDashboard:n.A},data(){return{systemPrompt:"你是一个友好的论坛助手，可以帮助用户回答问题、提供建议。",isOnline:!1,isScanning:!1,language:"cn",knowledgeBase:[],posts:[],deletedPosts:[],aiConfig:{protocol:"openai",apiKey:"",baseUrl:"https://api.openai.com/v1",modelId:"gpt-4-turbo",systemPrompt:"你是一个友好的论坛助手火妙，可以帮助用户回答问题、提供建议。"}}},mounted(){this.loadAiConfig(),this.loadKnowledgeBase(),this.loadSystemPrompt(),this.loadLanguage(),this.loadPosts()},methods:{async loadAiConfig(){try{const e=await this.fetchConfigFromBackend();if(e)this.aiConfig=e;else{const e=o.A.loadConfig();this.aiConfig={...this.aiConfig,...e}}this.isOnline=!(!this.aiConfig.apiKey||!this.aiConfig.apiKey.trim())}catch(e){console.error("加载 AI 配置失败:",e);try{const e=o.A.loadConfig();this.aiConfig={...this.aiConfig,...e},this.isOnline=!(!e.apiKey||!e.apiKey.trim())}catch(t){console.error("从本地加载配置也失败:",t),this.isOnline=!1}}},async fetchConfigFromBackend(){try{const e=await l.Ay.config.get();if((1===e.code||200===e.code)&&e.data){const t=o.A.loadConfig();return{protocol:e.data.protocol||"openai-compatible",apiKey:t.apiKey||"",baseUrl:e.data.baseUrl||"",modelId:e.data.modelId||"",systemPrompt:e.data.systemPrompt||"你是一个友好的论坛助手火妙，可以帮助用户回答问题、提供建议。",isOnline:e.data.isOnline}}return null}catch(e){return console.error("从后端获取配置失败:",e),null}},async loadKnowledgeBase(){try{const e=await l.Ay.knowledge.list({page:1,pageSize:100});if(1!==e.code&&200!==e.code||!e.data||!e.data.records)throw new Error(e.msg||"获取知识库失败");this.knowledgeBase=e.data.records,this.saveKnowledgeBase()}catch(e){console.error("从后端加载知识库失败，尝试从本地加载:",e);try{const e=localStorage.getItem("huomiao_knowledge_base");this.knowledgeBase=e?JSON.parse(e):[]}catch(t){console.error("从本地加载知识库也失败:",t),this.knowledgeBase=[]}}},saveKnowledgeBase(){localStorage.setItem("huomiao_knowledge_base",JSON.stringify(this.knowledgeBase))},loadSystemPrompt(){const e=localStorage.getItem("ai_system_prompt");e&&(this.systemPrompt=e)},loadLanguage(){const e=localStorage.getItem("ai_language");e&&(this.language=e)},async loadPosts(){try{const e=await r.A.post("/article/list",{pageNum:1,pageSize:100});200!==e.code&&1!==e.code||(this.posts=e.data.records||[])}catch(e){console.error("加载帖子失败:",e)}},handleUpdateAiConfig(e){this.aiConfig={...this.aiConfig,...e};try{o.A.saveConfig({protocol:this.aiConfig.protocol,apiKey:this.aiConfig.apiKey,baseUrl:this.aiConfig.baseUrl,modelId:this.aiConfig.modelId,systemPrompt:this.aiConfig.systemPrompt}),this.isOnline=!(!this.aiConfig.apiKey||!this.aiConfig.apiKey.trim()),this.$message.success("AI 配置已更新")}catch(t){console.error("更新 AI 配置失败:",t),this.$message.error("更新配置失败")}},async handleSetOnline(e){if(this.isOnline=e,e){if(!this.aiConfig.apiKey||!this.aiConfig.apiKey.trim())return this.$message.warning("请先配置 API Key"),void(this.isOnline=!1);try{const e=await o.A.saveConfig({protocol:this.aiConfig.protocol,apiKey:this.aiConfig.apiKey,baseUrl:this.aiConfig.baseUrl,modelId:this.aiConfig.modelId,systemPrompt:this.aiConfig.systemPrompt});e.success?(o.A.setOnline(!0),localStorage.setItem("huomiao_ai_online","true"),localStorage.setItem("huomiao_ai_config",JSON.stringify(o.A.loadConfig())),this.$message.success("AI 服务已连接")):(this.$message.error(e.message||"连接失败"),this.isOnline=!1)}catch(t){console.error("连接失败:",t),this.$message.error("连接失败: "+(t.message||"网络错误")),this.isOnline=!1}}else{try{await l.Ay.config.save({protocol:this.aiConfig.protocol,apiKey:"",baseUrl:this.aiConfig.baseUrl,modelId:this.aiConfig.modelId,systemPrompt:this.aiConfig.systemPrompt})}catch(t){console.error("更新后端状态失败:",t)}o.A.setOnline(!1),localStorage.setItem("huomiao_ai_online","false");const e=o.A.loadConfig();e.isOnline=0,localStorage.setItem("huomiao_ai_config",JSON.stringify(e)),localStorage.removeItem("huomiao_chat_history"),localStorage.setItem("huomiao_chat_cleared",Date.now().toString()),this.$message.info("AI 服务已断开，聊天记录已清除")}},async handleAddKnowledge(e){try{const t=await l.Ay.knowledge.add({title:e.title,content:e.content,category:e.category||"General",mediaType:e.mediaType||"none",mediaUrl:e.mediaUrl||""});if(1!==t.code&&200!==t.code||!t.data)throw new Error(t.msg||"添加失败");{const a={...e,id:t.data,createdAt:(new Date).toISOString()};this.knowledgeBase.push(a),this.saveKnowledgeBase(),this.$message.success("知识条目已添加到服务器")}}catch(t){console.error("添加知识条目失败:",t);try{e.id=Date.now().toString(),this.knowledgeBase.push(e),this.saveKnowledgeBase(),this.$message.warning("服务器添加失败，已保存到本地")}catch(a){console.error("本地保存也失败:",a),this.$message.error("添加失败")}}},async handleEditKnowledge(e,t){try{const a=await l.Ay.knowledge.update({id:e,title:t.title,content:t.content,category:t.category||"General",mediaType:t.mediaType||"none",mediaUrl:t.mediaUrl||""});if(1!==a.code&&200!==a.code)throw new Error(a.msg||"更新失败");{const a=this.knowledgeBase.findIndex((t=>t.id===e));-1!==a&&(this.$set(this.knowledgeBase,a,{...this.knowledgeBase[a],...t}),this.saveKnowledgeBase(),this.$message.success("知识条目已更新到服务器"))}}catch(a){console.error("更新知识条目失败:",a);try{const a=this.knowledgeBase.findIndex((t=>t.id===e));-1!==a&&(this.$set(this.knowledgeBase,a,{...this.knowledgeBase[a],...t}),this.saveKnowledgeBase(),this.$message.warning("服务器更新失败，已保存到本地"))}catch(s){console.error("本地保存也失败:",s),this.$message.error("更新失败")}}},async handleRemoveKnowledge(e){try{const t=await l.Ay.knowledge.delete(e);if(1!==t.code&&200!==t.code)throw new Error(t.msg||"删除失败");this.knowledgeBase=this.knowledgeBase.filter((t=>t.id!==e)),this.saveKnowledgeBase(),this.$message.success("知识条目已从服务器删除")}catch(t){console.error("删除知识条目失败:",t);try{this.knowledgeBase=this.knowledgeBase.filter((t=>t.id!==e)),this.saveKnowledgeBase(),this.$message.warning("服务器删除失败，已从本地移除")}catch(a){console.error("本地删除也失败:",a),this.$message.error("删除失败")}}},async handleRunModerationScan(){this.isScanning=!0;try{this.$message.info("审核扫描功能暂不可用（需要后端支持）")}catch(e){console.error("审核扫描失败:",e),this.$message.error("审核扫描失败")}finally{this.isScanning=!1}},handleUpdateSystemPrompt(e){this.systemPrompt=e,localStorage.setItem("ai_system_prompt",e),o.A.saveConfig({systemPrompt:e})},handleUpdateLanguage(e){this.language=e,localStorage.setItem("ai_language",e)},handleUpdatePosts(e){this.posts=e}}},d=c,u=a(81656),m=(0,u.A)(d,s,i,!1,null,"6e9c0514",null),p=m.exports},27946:function(e,t,a){a.d(t,{A:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"bg"},[t("div",{staticClass:"login-container"},[t("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.rules,"label-position":"left","label-width":"0px"}},[t("div",{staticClass:"title"},[t("i",{staticClass:"el-icon-s-platform"}),t("span",[e._v("论坛登录")])]),t("el-form-item",{attrs:{prop:"userName"}},[t("el-input",{staticClass:"login-input",attrs:{type:"text",autocomplete:"off","prefix-icon":"el-icon-user",placeholder:"请输入用户名"},model:{value:e.loginForm.userName,callback:function(t){e.$set(e.loginForm,"userName",t)},expression:"loginForm.userName"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{staticClass:"login-input",attrs:{type:"password",autocomplete:"off","prefix-icon":"el-icon-lock",placeholder:"请输入密码"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),t("el-form-item",{attrs:{prop:"code"}},[t("div",{staticClass:"captcha-wrapper"},[t("el-input",{staticClass:"login-input captcha-input",attrs:{"prefix-icon":"el-icon-key",placeholder:"请输入验证码答案"},model:{value:e.loginForm.checkcode,callback:function(t){e.$set(e.loginForm,"checkcode",t)},expression:"loginForm.checkcode"}}),t("div",{staticClass:"captcha-box",class:{loading:e.codeLoading},on:{click:e.getcode}},[e.codeLoading?t("i",{staticClass:"el-icon-loading"}):t("span",[e._v(e._s(e.captchaQuestion||"获取验证码"))]),t("i",{staticClass:"refresh-icon el-icon-refresh-right"})])],1)]),t("el-form-item",{attrs:{prop:"role"}},[t("el-select",{staticClass:"login-input role-select",attrs:{placeholder:"请选择角色","prefix-icon":"el-icon-user-solid"},model:{value:e.loginForm.role,callback:function(t){e.$set(e.loginForm,"role",t)},expression:"loginForm.role"}},e._l(e.roleOptions,(function(a){return t("el-option",{key:a.value,attrs:{label:a.label,value:a.value}},[t("i",{class:a.icon}),e._v(" "+e._s(a.label)+" ")])})),1)],1),t("el-form-item",[t("el-button",{staticClass:"login-button",attrs:{type:"primary",loading:e.codeLoading},on:{click:e.handleLogin}},[t("i",{staticClass:"el-icon-upload2"}),e._v(" 登录 ")])],1),t("div",{staticClass:"tip"},[t("span",[e._v("还没有账号？")]),t("span",{staticClass:"register-link",on:{click:function(t){return e.sjzhuce()}}},[e._v("立即注册")])])],1)],1)])},i=[],r=(a(44114),a(18962)),o={data(){return{image:"",codeLoading:!1,captchaQuestion:"",captchaId:"",loginForm:{userName:"",password:"",checkcode:"",captchaId:"",role:1},fileList:[],rules:{userName:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]}}},computed:{roleOptions(){const e=[{label:"用户",value:1,icon:"el-icon-user"}];return"admin"===this.loginForm.userName&&e.push({label:"管理员",value:2,icon:"el-icon-user"}),e}},watch:{"loginForm.userName"(e){2===this.loginForm.role&&"admin"!==e&&(this.loginForm.role=1)}},mounted(){this.getcode()},methods:{handleExceed(e){},async getcode(){if(!this.codeLoading){this.codeLoading=!0;try{const e=await r.A.get("/code");200===e.code&&e.data?(this.captchaQuestion=e.data.question,this.captchaId=e.data.captchaId,this.loginForm.captchaId=e.data.captchaId):this.$message.error(e.msg||"获取验证码失败")}catch(e){console.error("获取验证码失败:",e),this.$message.error("获取验证码失败，请稍后重试")}finally{this.codeLoading=!1}}},sjzhuce(){const e=this.$route.query.inviterId;e?this.$router.push({path:"/register",query:{inviterId:e}}):this.$router.push({path:"/register"})},handleLogin(){this.$refs.loginForm.validate((async e=>{if(!e)return!1;try{const e={userName:this.loginForm.userName,password:this.loginForm.password,captchaId:this.loginForm.captchaId,captchaAnswer:this.loginForm.checkcode,role:this.loginForm.role},t=await r.A.post("/login",e);200==t.code||1==t.code?(this.$message.success("登录成功"),window.localStorage.setItem("token",t.data.token),"admin"===this.loginForm.userName&&1!==this.loginForm.role?this.$router.push({path:"/home"}):1!==this.loginForm.role?this.$router.push({path:"/index"}):this.$router.push({path:"/userindex"})):(this.$message.warning(t.msg||"登录失败"),console.warn("登录失败，重新获取验证码"),this.loginForm.checkcode="",this.getcode())}catch(t){console.error("登录请求异常:",t),this.$message.error(t.msg||"登录失败，请检查网络连接"),this.loginForm.checkcode="",this.getcode()}}))}}},l=o,n=a(81656),c=(0,n.A)(l,s,i,!1,null,"39321552",null),d=c.exports},92010:function(e,t,a){a.d(t,{A:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"global"},[t("el-container",{staticClass:"global-contain"},[t("el-header",[t("div",{staticClass:"head"},[t("div",{staticClass:"headtitle"},[e._v("论坛系统")]),t("div",[null==e.user.avatar?t("img",{staticStyle:{"margin-right":"10px",width:"50px",height:"50px","border-radius":"50%","vertical-align":"middle"},attrs:{src:a(33153),alt:"",srcset:""}}):t("img",{staticStyle:{"margin-right":"10px",width:"50px",height:"50px","border-radius":"50%","vertical-align":"middle"},attrs:{src:e.user.avatar,alt:"",srcset:""}}),t("el-dropdown",[t("span",{staticClass:"el-dropdown-link",staticStyle:{color:"#fff"}},[e._v(" "+e._s(e.user.userName)),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.personal()}}},[e._v("个人信息")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.logout.apply(null,arguments)}}},[e._v("退出登录")])],1)],1)],1)])]),t("el-container",{staticClass:"contain"},[t("el-aside",{staticClass:"aside",attrs:{width:"200px"}},[t("el-menu",{staticClass:"el-menu-demo menu",attrs:{"default-active":e.$route.path,router:""}},[t("el-menu-item",{attrs:{index:"/home"}},[t("i",{staticClass:"el-icon-s-home menuicon"}),e._v("首页")]),t("el-submenu",{attrs:{index:"2"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-user menuicon"}),e._v("信息管理")]),t("el-menu-item",{attrs:{index:"/type"}},[e._v("板块管理")]),t("el-menu-item",{attrs:{index:"/article"}},[e._v("文章管理")]),t("el-menu-item",{attrs:{index:"/ai-settings"}},[e._v("AI设置管理")])],2)],1)],1),t("el-main",[t("router-view")],1)],1)],1)],1)},i=[],r=(a(44114),a(18962)),o={data(){return{user:{}}},mounted(){this.getinfo()},methods:{async getinfo(){const e=await r.A.get("/info");console.log(e),this.user=e.data,window.localStorage.setItem("userinfo",JSON.stringify(this.user))},personal(){this.$router.push({path:"/businessPersonal"})},updatepassword(){this.$router.push({path:"/password"})},async logout(){await r.A.post("/logout");window.localStorage.clear(),this.$router.push("/userhome")}}},l=o,n=a(81656),c=(0,n.A)(l,s,i,!1,null,"49a27880",null),d=c.exports},70414:function(e,t,a){a.d(t,{A:function(){return u}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticClass:"mb"},[t("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"请输入关键词搜索"},model:{value:e.queryform.keyword,callback:function(t){e.$set(e.queryform,"keyword",t)},expression:"queryform.keyword"}}),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.search()}}},[e._v("查询")]),t("el-button",{attrs:{type:"info",plain:""},on:{click:function(t){return e.research()}}},[e._v("重置")]),t("el-button",{staticStyle:{float:"right"},attrs:{type:"warning",plain:""},on:{click:function(t){return e.add()}}},[e._v("新增")])],1),t("el-card",[t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.tableData,strip:""}},[t("el-table-column",{attrs:{prop:"id",label:"序号",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"username",label:"账号"}}),t("el-table-column",{attrs:{label:"头像"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticStyle:{display:"flex","align-items":"center"}},[a.row.avatar?t("el-image",{staticStyle:{width:"40px",height:"40px","border-radius":"50%"},attrs:{src:a.row.avatar,"preview-src-list":[a.row.avatar]}}):e._e()],1)]}}])}),t("el-table-column",{attrs:{prop:"role",label:"角色"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.del(a.row.id)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.queryform.pageNum,"page-sizes":[5,10,20],"page-size":e.queryform.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)]),t("el-dialog",{attrs:{title:"管理员信息",visible:e.fromVisible,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"账号",prop:"username"}},[t("el-input",{attrs:{placeholder:"账号"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"姓名",prop:"name"}},[t("el-input",{attrs:{placeholder:"姓名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"头像"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/admin/common/upload","show-file-list":!1,"on-success":e.handleAvatarSuccess}},[""!==e.avatar?t("user-avatar",{attrs:{src:e.avatar,size:"medium",clickable:!1}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.fromVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)},i=[],r=a(18962),o=a(92646),l={components:{UserAvatar:o.A},data(){return{tableData:[],pageNum:1,pageSize:10,total:0,username:null,token:"",name:null,fromVisible:!1,avatar:"",queryform:{keyword:"",pageNum:1,pageSize:10},license:"",form:{avatar:"",license:""},user:JSON.parse(localStorage.getItem("userinfo")||"{}"),rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],type:[{required:!0,message:"请选择商家类型",trigger:"blur"}]},ids:[]}},mounted(){this.token=window.localStorage.getItem("token"),this.getlist()},methods:{del(e){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.get("/admin/delete?id="+e);console.log(t),1==t.code&&(this.$message({type:"success",message:"删除成功!"}),this.getlist())})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},force(e){this.form.timeRange=e,this.$forceUpdate()},handleEdit(e){this.form=e,this.avatar=e.avatar,this.license=e.license,this.form.timeRange=e.time_range,this.fromVisible=!0},search(){this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},research(){this.queryform.keyword="",this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},async getlist(){const e=await r.A.get("/admin/list",{params:this.queryform});console.log(e),1==e.code&&(this.tableData=e.data.records,this.total=e.data.total)},add(){this.avatar="",this.license="",this.form={},this.fromVisible=!0},handleLicenseSuccess(e){},async save(){this.form.avatar=this.avatar,this.form.role="ADMIN";const e=await r.A.post("/admin/addandupdate",this.form);1==e.code&&(this.fromVisible=!1,this.$message.success("操作成功"),this.getlist())},handleCurrentChange(e){this.queryform.pageNum=e,this.getlist()},handleAvatarSuccess(e){console.log(e),this.avatar=e.data,console.log(this.form.avatar)},handleAvatarSuccess1(e){this.license=e.data}}},n=l,c=a(81656),d=(0,c.A)(n,s,i,!1,null,"512a209a",null),u=d.exports},99512:function(e,t,a){a.d(t,{A:function(){return g}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticClass:"mb"},[t("el-cascader",{staticStyle:{"margin-right":"20px",width:"300px"},attrs:{placeholder:"请选择分类",options:e.typelist,props:e.categoryProps,clearable:"","show-all-levels":!1},on:{change:e.queryCategoryChange},model:{value:e.queryCategory,callback:function(t){e.queryCategory=t},expression:"queryCategory"}}),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.search()}}},[e._v("查询")]),t("el-button",{attrs:{type:"info",plain:""},on:{click:function(t){return e.research()}}},[e._v("重置")]),t("el-button",{staticStyle:{float:"right"},attrs:{type:"warning",plain:""},on:{click:function(t){return e.add()}}},[e._v("新增")])],1),t("el-card",[t("div",{staticClass:"table"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.sortedTableData,stripe:""}},[t("el-table-column",{attrs:{label:"置顶",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tooltip",{attrs:{content:1==a.row.topType?"已置顶":"未置顶"}},[t("i",{class:1==a.row.topType?"el-icon-top top-icon top-active":"el-icon-top top-icon",on:{click:function(t){return e.toggleTop(a.row)}}})])]}}])}),t("el-table-column",{attrs:{type:"index",label:"序号",width:"70",align:"center",sortable:""},scopedSlots:e._u([{key:"default",fn:function(a){return[1==a.row.topType?t("span",{staticClass:"top-badge"},[e._v("顶")]):e._e(),e._v(" "+e._s(a.$index+1)+" ")]}}])}),t("el-table-column",{attrs:{prop:"title",label:"标题",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"title-content"},[t("el-tooltip",{attrs:{content:a.row.title}},[t("div",{staticClass:"title",class:{"top-title":1==a.row.topType}},[e._v(e._s(a.row.title))])]),1==a.row.topType?t("el-tag",{staticClass:"top-tag",attrs:{type:"danger",size:"mini"}},[e._v("置顶")]):e._e()],1)]}}])}),t("el-table-column",{attrs:{prop:"content",label:"内容"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.chakan(a.row.content)}}},[e._v("查看")])]}}])}),t("el-table-column",{attrs:{prop:"cover",label:"封面",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.cover?t("el-image",{staticStyle:{width:"40px",height:"40px","border-radius":"50%"},attrs:{src:a.row.cover,"preview-src-list":[a.row.cover]}},[t("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[t("i",{staticClass:"el-icon-picture-outline"})])]):e._e()]}}])}),t("el-table-column",{attrs:{prop:"boardName",label:"分类",width:"120"}}),t("el-table-column",{attrs:{prop:"pboardName",label:"标签",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{size:"small"}},[e._v(e._s(a.row.pboardName))])]}}])}),t("el-table-column",{attrs:{prop:"nickName",label:"发布人",width:"100"}}),t("el-table-column",{attrs:{prop:"postTime",label:"发布日期",width:"140",sortable:""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"date-cell"},[t("i",{staticClass:"el-icon-time"}),t("span",[e._v(e._s(e.formatDate(a.row.postTime)))])])]}}])}),t("el-table-column",{attrs:{prop:"readCount",label:"浏览量",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"read-count"},[t("i",{staticClass:"el-icon-view"}),t("span",[e._v(e._s(a.row.readCount||0))])])]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"action-buttons"},[t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("修改")]),t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.del(a.row.id)}}},[e._v("删除")])],1)]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.queryform.pageNum,"page-sizes":[5,10,20],"page-size":e.queryform.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)]),t("el-dialog",{attrs:{title:"内容",visible:e.fromVisible1,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible1=t}}},[t("div",{domProps:{innerHTML:e._s(e.sanitizedContent)}})]),t("el-dialog",{attrs:{title:e.formTitle,visible:e.fromVisible,width:"40%","close-on-click-modal":!1,"custom-class":"article-edit-dialog"},on:{"update:visible":function(t){e.fromVisible=t},close:e.handleDialogClose}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"标题",prop:"title",required:""}},[t("el-input",{attrs:{placeholder:"请输入文章标题"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),t("el-form-item",{attrs:{label:"分类",required:""}},[t("el-cascader",{key:"cascader-"+(e.form.id||"new"),staticStyle:{width:"100%"},attrs:{options:e.typelist,props:e.categoryProps,"show-all-levels":!1,placeholder:"请选择文章分类",clearable:""},on:{change:e.handleCategoryChange},model:{value:e.selectedCategory,callback:function(t){e.selectedCategory=t},expression:"selectedCategory"}}),e.showCategoryError?t("div",{staticClass:"category-error-tip"},[e._v(" 请选择文章分类 ")]):e._e()],1),t("el-form-item",{attrs:{label:"摘要"}},[t("el-input",{attrs:{placeholder:"请输入摘要",type:"textarea",rows:3},model:{value:e.form.summary,callback:function(t){e.$set(e.form,"summary",t)},expression:"form.summary"}})],1),t("el-form-item",{attrs:{label:"文章置顶"}},[t("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":"置顶","inactive-text":"普通"},model:{value:e.form.topType,callback:function(t){e.$set(e.form,"topType",t)},expression:"form.topType"}}),1==e.form.topType?t("div",{staticClass:"top-tip"},[t("i",{staticClass:"el-icon-warning"}),e._v(" 置顶文章会显示在列表最前面 ")]):e._e()],1),t("el-form-item",{attrs:{label:"封面"}},[t("div",{staticClass:"cover-upload"},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.getUploadUrl(),"show-file-list":!1,"on-success":e.handleAvatarSuccess,"before-upload":e.beforeAvatarUpload}},[e.form.cover?t("div",{staticClass:"upload-area"},[t("img",{staticClass:"avatar",attrs:{src:e.coverPreview}}),t("div",{staticClass:"upload-mask"},[t("i",{staticClass:"el-icon-upload2"}),t("span",[e._v("更换封面")])])]):t("div",{staticClass:"upload-area empty"},[t("i",{staticClass:"el-icon-plus"}),t("div",{staticClass:"upload-text"},[e._v("上传封面图片")])])]),e.form.cover?t("div",{staticClass:"cover-tip"},[t("el-button",{staticClass:"remove-cover",attrs:{type:"text"},on:{click:function(t){e.form.cover=""}}},[t("i",{staticClass:"el-icon-delete"}),e._v("移除封面 ")])],1):e._e()],1)]),t("el-form-item",{attrs:{label:"内容",required:""}},[t("div",{staticClass:"editor-wrapper"},[t("div",{staticClass:"wang-editor-container",attrs:{id:"editor"}}),e.form.content?e._e():t("div",{staticClass:"editor-tip"},[e._v("文章内容不能为空")])])])],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.fromVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary",loading:e.submitting},on:{click:e.save}},[e._v(" "+e._s(e.submitting?"保存中...":"确 定")+" ")])],1)],1)],1)},i=[],r=(a(81454),a(18962)),o=a(5507),l=a.n(o),n=a(40981);a(14603),a(47566),a(98721);class c{validateUsername(e){if(!e||"string"!==typeof e)return{valid:!1,message:"用户名不能为空"};const t=e.trim();if(t.length<3||t.length>20)return{valid:!1,message:"用户名长度必须在3-20个字符之间"};const a=/^[a-zA-Z0-9_]+$/;return a.test(t)?{valid:!0,value:t}:{valid:!1,message:"用户名只能包含字母、数字和下划线"}}validatePassword(e){if(!e||"string"!==typeof e)return{valid:!1,message:"密码不能为空"};if(e.length<6)return{valid:!1,message:"密码长度至少为6个字符"};if(e.length>32)return{valid:!1,message:"密码长度不能超过32个字符"};const t=/[a-zA-Z]/.test(e),a=/[0-9]/.test(e);return t&&a?{valid:!0}:{valid:!0,message:"建议密码包含字母和数字，以提高安全性"}}validateConfirmPassword(e,t){return t?e!==t?{valid:!1,message:"两次输入的密码不一致"}:{valid:!0}:{valid:!1,message:"请确认密码"}}validateEmail(e){if(!e||"string"!==typeof e)return{valid:!1,message:"邮箱不能为空"};const t=e.trim(),a=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return a.test(t)?{valid:!0,value:t.toLowerCase()}:{valid:!1,message:"请输入有效的邮箱地址"}}validatePhone(e){if(!e||"string"!==typeof e)return{valid:!1,message:"手机号不能为空"};const t=e.trim(),a=/^1[3-9]\d{9}$/;return a.test(t)?{valid:!0,value:t}:{valid:!1,message:"请输入有效的手机号码"}}validateTitle(e){if(!e||"string"!==typeof e)return{valid:!1,message:"标题不能为空"};const t=e.trim();return t.length<2?{valid:!1,message:"标题长度至少为2个字符"}:t.length>100?{valid:!1,message:"标题长度不能超过100个字符"}:{valid:!0,value:t}}validateContent(e){if(!e||"string"!==typeof e)return{valid:!1,message:"内容不能为空"};const t=e.trim();return 0===t.length?{valid:!1,message:"内容不能为空"}:t.length<10?{valid:!1,message:"内容长度至少为10个字符"}:t.length>5e4?{valid:!1,message:"内容长度不能超过50000个字符"}:{valid:!0,value:t}}sanitizeInput(e){return e&&"string"===typeof e?e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):""}validateURL(e){if(!e||"string"!==typeof e)return{valid:!1,message:"URL不能为空"};try{return new URL(e),{valid:!0,value:e}}catch{return{valid:!1,message:"请输入有效的URL地址"}}}validateLength(e,t=0,a=1/0,s="字段"){if(!e||"string"!==typeof e)return{valid:!1,message:`${s}不能为空`};const i=e.trim();return i.length<t?{valid:!1,message:`${s}长度至少为${t}个字符`}:i.length>a?{valid:!1,message:`${s}长度不能超过${a}个字符`}:{valid:!0,value:i}}}var d=new c,u={data(){return{fileList:[],typelist:[],tableData:[],pageNum:1,pageSize:20,total:0,username:null,token:"",queryCategory:[],selectedCategory:[],showCategoryError:!1,categoryProps:{value:"id",label:"name",checkStrictly:!0,expandTrigger:"hover"},name:null,fromVisible1:!1,fromVisible:!1,avatar:"",submitting:!1,queryform:{boardId:"",pageNum:1,pBoardId:"",status:"",pageSize:20},license:"",form:{id:"",title:"",summary:"",cover:"",pBoardId:"",boardId:"",topType:0,content:""},user:{},rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"},{min:2,max:100,message:"长度在 2 到 100 个字符",trigger:"blur"}]},content:"",editor:null}},computed:{formTitle(){return this.form.id?"编辑文章":"新增文章"},coverPreview(){if(!this.form.cover)return"";if(/^https?:\/\//.test(this.form.cover))return this.form.cover;const e="https://orkj406039jmw6me.top/";return`${e}${this.form.cover}`},sanitizedContent(){return this.content?this.sanitizeHTML(this.content):""},sortedTableData(){return this.tableData&&0!==this.tableData.length?[...this.tableData].sort(((e,t)=>e.topType!==t.topType?t.topType-e.topType:new Date(t.postTime)-new Date(e.postTime))):[]}},watch:{fromVisible(e){e?this.$nextTick((()=>{this.initEditor(),setTimeout((()=>{this.initCascaderClickHandler()}),100)})):this.editor&&(this.editor.destroy(),this.editor=null)}},mounted(){this.token=window.localStorage.getItem("token"),this.user=JSON.parse(window.localStorage.getItem("userinfo")),this.getall(),this.getlist(),this.$nextTick((()=>{this.initCascaderClickHandler()}))},beforeDestroy(){document.removeEventListener("click",this.handleCascaderGlobalClick,!0),this.editor&&(this.editor.destroy(),this.editor=null)},methods:{initCascaderClickHandler(){document.addEventListener("click",this.handleCascaderGlobalClick,!0)},handleCascaderGlobalClick(e){const t=e.target;if(t.classList.contains("el-cascader-node__label")){const a=t.closest(".el-cascader-node");if(a){const t=a.querySelector(".el-radio__input");t&&(t.click(),e.stopPropagation(),e.preventDefault())}}},getImageUrl(e){return e?"string"===typeof e&&(e.startsWith("http://")||e.startsWith("https://"))?e:"https://orkj406039jmw6me.top/api/file/getImage/"+e:""},getUploadUrl(){return"https://orkj406039jmw6me.top/api/file/upload"},sanitizeHTML(e){if(!e)return"";const t=document.createElement("div");t.innerHTML=e;const a=["SCRIPT","STYLE","IFRAME","OBJECT","EMBED","FORM","INPUT","BUTTON"],s=["onload","onerror","onclick","onmouseover","onfocus","onblur","onkeydown","onkeyup","onsubmit","javascript:","data:text/html"],i=e=>{if(1===e.nodeType){if(a.includes(e.tagName))return void e.remove();const t=e.attributes;for(let a=t.length-1;a>=0;a--){const i=t[a],r=i.name.toLowerCase(),o=i.value.toLowerCase();s.some((e=>r.includes(e.toLowerCase())||o.includes(e.toLowerCase())))&&e.removeAttribute(i.name)}const r=e.childNodes;for(let e=r.length-1;e>=0;e--)i(r[e])}},r=t.childNodes;for(let o=r.length-1;o>=0;o--)i(r[o]);return t.innerHTML},queryCategoryChange(e){n.A.log("查询分类变化:",e),e&&e.length>0?this.queryform.boardId=e[e.length-1]:this.queryform.boardId=""},handleCategoryChange(e){n.A.log("编辑分类变化:",e),this.showCategoryError=!1,e&&e.length>0?e.length>1?(this.form.pBoardId=e[0],this.form.boardId=e[1]):1===e.length&&(this.form.pBoardId=e[0],this.form.boardId=""):(this.form.pBoardId="",this.form.boardId="",this.showCategoryError=!0)},chakan(e){this.content=e,this.fromVisible1=!0},cleanCategoryData(e){return e&&Array.isArray(e)?e.map((e=>{const t={...e};return t.children&&Array.isArray(t.children)&&(0===t.children.length?delete t.children:t.children=this.cleanCategoryData(t.children)),t})):[]},async getall(){const e=await r.A.get("/board/list");n.A.log("分类列表:",e),this.typelist=this.cleanCategoryData(e.data)},del(e){this.$confirm("此操作将永久删除该文章, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.post("/article/delete",{id:e});n.A.log(t),200!=t.code&&1!=t.code||(this.$message({type:"success",message:"删除成功!"}),this.getlist())})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},toggleTop(e){const t=1==e.topType?"取消置顶":"置顶";this.$confirm(`确定要${t}这篇文章吗？`,"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{try{const a=1==e.topType?0:1,s=await r.A.post("/article/setTop",{id:e.id,topType:a});200==s.code||1==s.code?(this.$message.success(`${t}成功`),e.topType=a,this.sortTableData()):this.$message.error(s.message||`${t}失败`)}catch(a){n.A.error(`${t}失败:`,a),this.$message.error(`${t}失败，请稍后重试`)}})).catch((()=>{}))},sortTableData(){this.tableData=this.tableData.sort(((e,t)=>e.topType!==t.topType?t.topType-e.topType:new Date(t.postTime)-new Date(e.postTime)))},handleEdit(e){n.A.log("编辑文章数据:",e),this.form={id:e.id,title:e.title||"",summary:e.summary||"",cover:e.cover||"",topType:e.topType||0,pBoardId:"",boardId:"",content:e.content||""};const t=e.pboardId||e.pBoardId,a=e.boardId;n.A.log("文章分类ID:",{pId:t,bId:a}),this.selectedCategory=[],t&&a?(this.selectedCategory=[parseInt(t),parseInt(a)],this.form.pBoardId=parseInt(t),this.form.boardId=parseInt(a)):t&&(this.selectedCategory=[parseInt(t)],this.form.pBoardId=parseInt(t),this.form.boardId=""),n.A.log("设置后的分类值:",this.selectedCategory),n.A.log("设置后的表单:",this.form),this.fromVisible=!0,this.$nextTick((()=>{n.A.log("弹窗打开后的分类值:",this.selectedCategory)}))},search(){this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},research(){this.queryform.boardId="",this.queryform.pBoardId="",this.queryform.pageNum=1,this.queryCategory=[],this.queryform.pageSize=10,this.getlist()},async getlist(){const e=await r.A.post("/article/list",this.queryform);n.A.log("文章列表:",e),200!=e.code&&1!=e.code||(this.tableData=e.data.records,this.total=e.data.total,this.sortTableData())},add(){this.form={id:"",title:"",summary:"",cover:"",topType:0,pBoardId:"",boardId:"",content:""},this.selectedCategory=[],this.showCategoryError=!1,this.fromVisible=!0,this.$nextTick((()=>{n.A.log("新增文章表单已重置:",this.form)}))},initEditor(){this.$nextTick((()=>{this.editor&&(this.editor.destroy(),this.editor=null),this.editor=new(l())("#editor"),this.editor.config.placeholder="请输入文章内容...",this.editor.config.uploadFileName="file",this.editor.config.uploadImgServer=this.getUploadUrl(),this.editor.config.zIndex=100,this.editor.config.uploadImgMaxSize=5242880,this.editor.config.uploadImgAccept=["jpg","jpeg","png","gif","webp"],this.editor.config.uploadImgResult="json",this.editor.config.uploadImgHooks={customInsert:(e,t)=>{let a="";try{console.log("图片上传后端响应:",t),console.log("响应码:",t.code),console.log("响应数据:",t.data),200===t.code||1===t.code?(console.log("上传成功，响应码:",t.code),"string"===typeof t.data?a=t.data.startsWith("http://")||t.data.startsWith("https://")?t.data:this.getImageUrl(t.data):t.data&&t.data.url?a=t.data.url:t.data&&(a=this.getImageUrl(t.data))):0===t.errno&&t.data?a=t.data.url||this.getImageUrl(t.data):t.data?a=this.getImageUrl(t.data):t.url?a=t.url:"string"===typeof t&&(a=t),console.log("最终图片URL:",a),a?(e(a),this.$message.success("图片上传成功")):(console.error("无法获取图片地址，响应数据:",t),this.$message.error("图片上传失败：无法获取图片地址"))}catch(s){console.error("customInsert 处理异常:",s),this.$message.error("图片处理失败")}}},this.editor.config.onchange=e=>{this.form.content=e},this.editor.create(),this.form.content&&this.editor.txt.html(this.form.content)}))},validateForm(){const e=d.validateTitle(this.form.title);if(!e.valid)return this.$message.warning(e.message),!1;if(!this.form.pBoardId)return this.showCategoryError=!0,this.$message.warning("请选择文章分类"),!1;const t=d.validateContent(this.form.content);return!!t.valid||(this.$message.warning(t.message),!1)},async save(){const e=this.validateForm();if(e){this.submitting=!0;try{const e={title:this.form.title,summary:this.form.summary||"",cover:this.form.cover||"",pBoardId:this.form.pBoardId,boardId:this.form.boardId||"",topType:this.form.topType||0,content:this.form.content};let t;this.form.id?(e.id=this.form.id,t=await r.A.post("/article/update",e)):t=await r.A.post("/article/post",e),200==t.code||1==t.code?(this.$message.success(this.form.id?"文章更新成功":"文章发布成功"),this.fromVisible=!1,this.getlist()):this.$message.error(t.message||"操作失败")}catch(t){n.A.error("保存失败:",t),this.$message.error("操作失败，请稍后重试")}finally{this.submitting=!1}}},handleCurrentChange(e){this.queryform.pageNum=e,this.getlist()},handleAvatarSuccess(e){200===e.code?(this.form.cover=e.data,n.A.log(this.form.cover),this.$message.success("封面图片上传成功")):this.$message.error("图片上传失败")},beforeAvatarUpload(e){const t=/^image\/(jpeg|png|jpg|gif|webp)$/.test(e.type),a=e.size/1024/1024<5;return t?!!a||(this.$message.error("图片大小不能超过5MB!"),!1):(this.$message.error("只能上传图片格式文件!"),!1)},handleDialogClose(){this.selectedCategory=[],this.showCategoryError=!1},formatDate(e){if(!e)return"";const t=new Date(e);return t.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"})}}},m=u,p=a(81656),h=(0,p.A)(m,s,i,!1,null,"877c557a",null),g=h.exports},90245:function(e,t,a){a.d(t,{A:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticClass:"mb"},[t("el-button",{attrs:{type:"warning",plain:""},on:{click:function(t){return e.add()}}},[e._v("新增")])],1),t("el-card",[t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.tableData,strip:""}},[t("el-table-column",{attrs:{prop:"id",label:"序号",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"img",label:"图片"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticStyle:{display:"flex","align-items":"center"}},[a.row.img?t("el-image",{staticStyle:{width:"40px",height:"40px"},attrs:{src:a.row.img,"preview-src-list":[a.row.img]}}):e._e()],1)]}}])}),t("el-table-column",{attrs:{prop:"name",label:"商家"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.del(a.row.id)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.queryform.pageNum,"page-sizes":[5,10,20],"page-size":e.queryform.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)]),t("el-dialog",{attrs:{title:"广告信息",visible:e.fromVisible,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"图片",prop:"img"}},[t("el-upload",{attrs:{action:"/files/upload",headers:{token:e.user.token},"file-list":e.fileList,"on-success":e.handleFileSuccess}},[t("el-button",{attrs:{type:"primary"}},[e._v("上传")])],1)],1),"ADMIN"==e.user.role?t("el-form-item",{attrs:{label:"商家",prop:"business_id"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.form.business_id,callback:function(t){e.$set(e.form,"business_id",t)},expression:"form.business_id"}},e._l(e.sjlist,(function(e){return t("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})})),1)],1):e._e()],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.fromVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)},i=[],r=(a(44114),a(18962)),o={data(){return{fileList:[],tableData:[],pageNum:1,pageSize:10,total:0,username:null,token:"",name:null,fromVisible:!1,avatar:"",queryform:{keyword:"",pageNum:1,pageSize:10},license:"",form:{avatar:"",license:""},user:{},rules:{cname:[{required:!0,message:"请输入名称",trigger:"blur"}]},ids:[],sjlist:[]}},mounted(){this.token=window.localStorage.getItem("token"),this.user=JSON.parse(window.localStorage.getItem("userinfo")),console.log(this.user),this.getall(),this.getlist()},methods:{handleFileSuccess(e){console.log(e),this.form.img=e.data},async getall(){const e=await r.A.get("/Business/all");console.log(e),this.sjlist=e.data.list},del(e){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.post("/Banner/delete?id="+e);console.log(t),1==t.code&&(this.$message({type:"success",message:"删除成功!"}),this.getlist())})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},force(e){this.form.timeRange=e,this.$forceUpdate()},handleEdit(e){this.form=e,this.fileList=[],this.fileList.push({name:"图片",url:e.img}),this.fromVisible=!0},search(){this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},research(){this.queryform.keyword="",this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},async getlist(){"BUSINESS"==this.user.role&&(this.queryform.businessId=this.user.id);const e=await r.A.post("/Banner/list",this.queryform);console.log(e),1==e.code&&(this.tableData=e.data.rows,this.total=e.data.total)},add(){this.avatar="",this.license="",this.form={},this.fromVisible=!0},handleLicenseSuccess(e){},async save(){let e="";if(e="BUSINESS"==this.user.role?this.user.id:this.form.business_id,this.form.id){const t=await r.A.post("/Banner/update",{id:this.form.id,img:this.form.img,businessId:e});1==t.code&&(this.fromVisible=!1,this.$message.success("操作成功"),this.getlist())}else{const t=await r.A.post("/Banner/add",{img:this.form.img,businessId:e});1==t.code&&(this.fromVisible=!1,this.$message.success("操作成功"),this.getlist())}},handleCurrentChange(e){},handleAvatarSuccess(e){console.log(e),this.avatar=e.data,console.log(this.form.avatar)},handleAvatarSuccess1(e){this.license=e.data}}},l=o,n=a(81656),c=(0,n.A)(l,s,i,!1,null,"a97fca9a",null),d=c.exports},96871:function(e,t,a){a.d(t,{A:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticStyle:{width:"50%"}},[t("el-form",{staticStyle:{"padding-right":"50px"},attrs:{model:e.user,"label-width":"100px"}},[t("div",{staticStyle:{margin:"15px","text-align":"center"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/files/upload","show-file-list":!1,"on-success":e.handleAvatarSuccess}},[e.user.avatar?t("img",{staticClass:"avatar",attrs:{src:e.user.avatar}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t("el-form-item",{attrs:{label:"账号",prop:"userName"}},[t("el-input",{attrs:{disabled:"",placeholder:"账号"},model:{value:e.user.userName,callback:function(t){e.$set(e.user,"userName",t)},expression:"user.userName"}})],1),t("el-form-item",{attrs:{label:"当前登陆地",prop:"phone"}},[t("el-input",{attrs:{readonly:"",placeholder:"当前登陆地"},model:{value:e.user.loginAddress,callback:function(t){e.$set(e.user,"loginAddress",t)},expression:"user.loginAddress"}})],1),t("el-form-item",{attrs:{label:"当前登录IP",prop:"email"}},[t("el-input",{attrs:{readonly:"",placeholder:"当前登录IP"},model:{value:e.user.loginIp,callback:function(t){e.$set(e.user,"loginIp",t)},expression:"user.loginIp"}})],1),t("div",{staticStyle:{"text-align":"center","margin-bottom":"20px"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("保 存")])],1)],1)],1)],1)},i=[],r=a(18962),o={name:"AdminPerson",data(){return{user:{}}},created(){},mounted(){console.log(window.localStorage.getItem("userinfo")),this.user=JSON.parse(window.localStorage.getItem("userinfo"))},methods:{handleAvatarSuccess(e,t,a){this.$set(this.user,"avatar",e.data)},async update(){const e=await r.A.post("/admin/addandupdate",this.user);console.log(e),1==e.code&&(this.$message.success(e.data),window.localStorage.setItem("userinfo",JSON.stringify(this.user)))},handleAvatarSuccess1(e,t,a){this.$set(this.user,"license",e.data)}}},l=o,n=a(81656),c=(0,n.A)(l,s,i,!1,null,"627f6e66",null),d=c.exports},15932:function(e,t,a){a.d(t,{A:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticClass:"mb"},[t("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"请输入关键词搜索"},model:{value:e.queryform.keyword,callback:function(t){e.$set(e.queryform,"keyword",t)},expression:"queryform.keyword"}}),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.search()}}},[e._v("查询")]),t("el-button",{attrs:{type:"info",plain:""},on:{click:function(t){return e.research()}}},[e._v("重置")]),"HOTEL"==e.user.role?t("el-button",{staticStyle:{float:"right"},attrs:{type:"warning",plain:""},on:{click:function(t){return e.add()}}},[e._v("新增")]):e._e()],1),t("el-card",[t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.tableData,strip:""}},[t("el-table-column",{attrs:{prop:"id",label:"序号",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"img",label:"房间图片"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticStyle:{display:"flex","align-items":"center"}},[a.row.img?t("el-image",{staticStyle:{width:"40px",height:"40px","border-radius":"50%"},attrs:{src:a.row.img,"preview-src-list":[a.row.img]}}):e._e()],1)]}}])}),t("el-table-column",{attrs:{prop:"name",label:"分类"}}),t("el-table-column",{attrs:{prop:"description",label:"分类描述"}}),t("el-table-column",{attrs:{prop:"price",label:"价格"}}),t("el-table-column",{attrs:{prop:"hotalname",label:"酒店"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.del(a.row.id)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.queryform.pageNum,"page-sizes":[5,10,20],"page-size":e.queryform.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)]),t("el-dialog",{attrs:{title:"房间分类",visible:e.fromVisible,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"分类",prop:"cname"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{action:"/files/upload","show-file-list":!1,"on-success":e.handleAvatarSuccess}},[""!==e.img?t("img",{staticClass:"avatar",attrs:{src:e.img}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t("el-form-item",{attrs:{label:"分类名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"分类描述",prop:"description"}},[t("el-input",{attrs:{placeholder:"名称"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),t("el-form-item",{attrs:{label:"价格",prop:"price"}},[t("el-input",{attrs:{placeholder:"价格"},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.fromVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)},i=[],r=a(18962),o={data(){return{tableData:[],pageNum:1,pageSize:10,total:0,username:null,img:"",token:"",name:null,fromVisible:!1,avatar:"",queryform:{keyword:"",pageNum:1,pageSize:10},license:"",form:{img:""},user:{},rules:{cname:[{required:!0,message:"请输入名称",trigger:"blur"}]},ids:[],sjlist:[]}},mounted(){this.token=window.localStorage.getItem("token"),this.user=JSON.parse(window.localStorage.getItem("userinfo")),console.log(this.user),this.getlist()},methods:{del(e){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.get("/hotal/typedelete?id="+e);console.log(t),1==t.code&&(this.$message({type:"success",message:"删除成功!"}),this.getlist())})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},force(e){this.form.timeRange=e,this.$forceUpdate()},handleEdit(e){this.form=e,this.img=e.img,this.fromVisible=!0},search(){this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},research(){this.queryform.keyword="",this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},async getlist(){"HOTEL"==this.user.role?this.queryform.hotelId=this.user.id:this.queryform.hotelId="";const e=await r.A.get("/hotal/typelist",{params:this.queryform});console.log(e),1==e.code&&(this.tableData=e.data.records,this.total=e.data.total)},add(){this.img="",this.form={},this.fromVisible=!0},handleLicenseSuccess(e){},async save(){let e="";e="HOTEL"==this.user.role?this.user.id:this.form.hotelId,this.form.hotelId=e,this.form.img=this.img;const t=await r.A.post("/hotal/typeadd",this.form);1==t.code&&(this.fromVisible=!1,this.$message.success("操作成功"),this.getlist())},handleCurrentChange(e){},handleAvatarSuccess(e){console.log(e),this.img=e.data,console.log(this.img)}}},l=o,n=a(81656),c=(0,n.A)(l,s,i,!1,null,"02e271db",null),d=c.exports},63907:function(e,t,a){a.d(t,{A:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticClass:"mb"},[t("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"请输入关键词搜索"},model:{value:e.queryform.keyword,callback:function(t){e.$set(e.queryform,"keyword",t)},expression:"queryform.keyword"}}),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.search()}}},[e._v("查询")]),t("el-button",{attrs:{type:"info",plain:""},on:{click:function(t){return e.research()}}},[e._v("重置")])],1),t("el-card",[t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.tableData,strip:""}},[t("el-table-column",{attrs:{prop:"id",label:"序号",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"content",label:"名称"}}),t("el-table-column",{attrs:{prop:"name",label:"评分"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-rate",{model:{value:a.row.star,callback:function(t){e.$set(a.row,"star",t)},expression:"scope.row.star"}})]}}])}),t("el-table-column",{attrs:{prop:"name",label:"商家名称"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.del(a.row.id)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.queryform.pageNum,"page-sizes":[5,10,20],"page-size":e.queryform.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)]),t("el-dialog",{attrs:{title:"商家分类",visible:e.fromVisible,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"分类",prop:"cname"}},[t("el-input",{attrs:{placeholder:"分类"},model:{value:e.form.cname,callback:function(t){e.$set(e.form,"cname",t)},expression:"form.cname"}})],1),"ADMIN"==e.user.role?t("el-form-item",{attrs:{label:"商家",prop:"business_id"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.form.business_id,callback:function(t){e.$set(e.form,"business_id",t)},expression:"form.business_id"}},e._l(e.sjlist,(function(e){return t("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})})),1)],1):e._e()],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.fromVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)},i=[],r=a(18962),o={data(){return{tableData:[],pageNum:1,pageSize:10,total:0,username:null,token:"",name:null,fromVisible:!1,avatar:"",queryform:{keyword:"",pageNum:1,pageSize:10},license:"",form:{avatar:"",license:""},user:{},rules:{cname:[{required:!0,message:"请输入名称",trigger:"blur"}]},ids:[],sjlist:[],fromVisible1:!1}},mounted(){this.token=window.localStorage.getItem("token"),this.user=JSON.parse(window.localStorage.getItem("userinfo")),console.log(this.user),this.getall(),this.getlist()},methods:{chakan(e){this.content=e,this.fromVisible1=!0},async getall(){const e=await r.A.get("/Business/all");console.log(e),this.sjlist=e.data.list},del(e){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.post("/comment/delete?id="+e);console.log(t),1==t.code&&(this.$message({type:"success",message:"删除成功!"}),this.getlist())})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},force(e){this.form.timeRange=e,this.$forceUpdate()},handleEdit(e){this.form=e,this.avatar=e.avatar,this.license=e.license,this.form.timeRange=e.time_range,this.fromVisible=!0},search(){this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},research(){this.queryform.keyword="",this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},async getlist(){"BUSINESS"==this.user.role&&(this.queryform.businessId=this.user.id);const e=await r.A.post("/comment/list",this.queryform);console.log(e),1==e.code&&(this.tableData=e.data.rows,this.total=e.data.total)},add(){this.avatar="",this.license="",this.form={},this.fromVisible=!0},handleLicenseSuccess(e){},async save(){let e="";if(e="BUSINESS"==this.user.role?this.user.id:this.form.business_id,this.form.id){const t=await r.A.post("/Category/update",{id:this.form.id,cname:this.form.cname,businessId:e});1==t.code&&(this.fromVisible=!1,this.$message.success("操作成功"),this.getlist())}else{const t=await r.A.post("/Category/add",{cname:this.form.cname,businessId:e});1==t.code&&(this.fromVisible=!1,this.$message.success("操作成功"),this.getlist())}},handleCurrentChange(e){},handleAvatarSuccess(e){console.log(e),this.avatar=e.data,console.log(this.form.avatar)},handleAvatarSuccess1(e){this.license=e.data}}},l=o,n=a(81656),c=(0,n.A)(l,s,i,!1,null,"9a28091c",null),d=c.exports},77782:function(e,t,a){a.d(t,{A:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",[t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.tableData,strip:""}},[t("el-table-column",{attrs:{prop:"id",label:"序号",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"username",label:"用户"}}),t("el-table-column",{attrs:{prop:"content",label:"评价信息"}}),t("el-table-column",{attrs:{prop:"createTime",label:"评价时间"}}),t("el-table-column",{attrs:{prop:"gname",label:"商品名称"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[e.user&&String(e.user.userId)===String(a.row.userId)?t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.del(a.row.id)}}},[e._v("删除")]):e._e()]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.queryform.pageNum,"page-sizes":[5,10,20],"page-size":e.queryform.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)]),t("el-dialog",{attrs:{title:"商家分类",visible:e.fromVisible,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"分类",prop:"cname"}},[t("el-input",{attrs:{placeholder:"分类"},model:{value:e.form.cname,callback:function(t){e.$set(e.form,"cname",t)},expression:"form.cname"}})],1),"ADMIN"==e.user.role?t("el-form-item",{attrs:{label:"商家",prop:"business_id"}},[t("el-select",{staticStyle:{width:"100%"},model:{value:e.form.business_id,callback:function(t){e.$set(e.form,"business_id",t)},expression:"form.business_id"}},e._l(e.sjlist,(function(e){return t("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})})),1)],1):e._e()],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.fromVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)},i=[],r=a(18962),o={data(){return{tableData:[],pageNum:1,pageSize:10,total:0,username:null,token:"",name:null,fromVisible:!1,avatar:"",queryform:{keyword:"",pageNum:1,pageSize:10},license:"",form:{avatar:"",license:""},user:{},rules:{cname:[{required:!0,message:"请输入名称",trigger:"blur"}]},ids:[],sjlist:[]}},mounted(){this.token=window.localStorage.getItem("token"),this.user=JSON.parse(window.localStorage.getItem("userinfo")),console.log(this.user),this.getlist()},methods:{async getall(){const e=await r.A.get("/Business/all");console.log(e),this.sjlist=e.data.list},del(e){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.get("/comment/delete?id="+e);console.log(t),1==t.code&&(this.$message({type:"success",message:"删除成功!"}),this.getlist())})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},force(e){this.form.timeRange=e,this.$forceUpdate()},handleEdit(e){this.form=e,this.avatar=e.avatar,this.license=e.license,this.form.timeRange=e.time_range,this.fromVisible=!0},search(){this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},research(){this.queryform.keyword="",this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},async getlist(){const e=await r.A.get("/comment/allist",{params:this.queryform});console.log(e),1==e.code&&(this.tableData=e.data.records,this.total=e.data.total)},add(){this.avatar="",this.license="",this.form={},this.fromVisible=!0},handleLicenseSuccess(e){},async save(){let e="";if(e="BUSINESS"==this.user.role?this.user.id:this.form.business_id,this.form.id){const t=await r.A.post("/Category/update",{id:this.form.id,cname:this.form.cname,businessId:e});1==t.code&&(this.fromVisible=!1,this.$message.success("操作成功"),this.getlist())}else{const t=await r.A.post("/Category/add",{cname:this.form.cname,businessId:e});1==t.code&&(this.fromVisible=!1,this.$message.success("操作成功"),this.getlist())}},handleCurrentChange(e){},handleAvatarSuccess(e){console.log(e),this.avatar=e.data,console.log(this.form.avatar)},handleAvatarSuccess1(e){this.license=e.data}}},l=o,n=a(81656),c=(0,n.A)(l,s,i,!1,null,"2b2a68d6",null),d=c.exports},54307:function(e,t,a){a.d(t,{A:function(){return u}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",[t("h3",[e._v("欢迎使用本系统")]),t("div",{staticClass:"main"},[t("div",{attrs:{id:"main"}}),t("div",{attrs:{id:"main1"}})])])],1)},i=[],r=a(84823),o=a(18962),l={data(){return{cs:"",name:"各门店商品量",xdata:[],user:{},ydata:[]}},mounted(){this.user=JSON.parse(window.localStorage.getItem("userinfo"))},methods:{async initEcharts(){const e=await o.A.post("/chart/sptj");console.log(e);const t={tooltip:{trigger:"item"},title:{text:"分类商品统计"},xAxis:{type:"category",data:e.data.x},yAxis:{type:"value"},series:[{name:"分类商品统计",type:"pie",radius:"55%",data:e.data}]},a=r.Ts(document.getElementById("main"));a.setOption(t),window.addEventListener("resize",(()=>{a.resize()}))},async initEcharts1(){const e=await o.A.post("/chart/xstj");console.log(e);const t={title:{text:"热门商品排行",subtext:"Fake Data",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},xAxis:{type:"category",boundaryGap:!1,data:e.data.x},yAxis:{type:"value"},series:[{type:"bar",data:e.data.y}]},a=r.Ts(document.getElementById("main1"));a.setOption(t),window.addEventListener("resize",(()=>{a.resize()}))}}},n=l,c=a(81656),d=(0,c.A)(n,s,i,!1,null,null,null),u=d.exports},47797:function(e,t,a){a.d(t,{A:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticClass:"mb"},[t("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"请输入关键词搜索"},model:{value:e.queryform.keyword,callback:function(t){e.$set(e.queryform,"keyword",t)},expression:"queryform.keyword"}}),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.search()}}},[e._v("查询")]),t("el-button",{attrs:{type:"info",plain:""},on:{click:function(t){return e.research()}}},[e._v("重置")])],1),t("el-card",[t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.tableData,strip:""}},[t("el-table-column",{attrs:{prop:"id",label:"序号",width:"70",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"name",label:"名称"}}),t("el-table-column",{attrs:{prop:"rightreply",label:"答案"}}),t("el-table-column",{attrs:{prop:"tikuname",label:"所属题库"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"350"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.del(a.row.id)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.queryform.pageNum,"page-sizes":[5,10,20],"page-size":e.queryform.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)]),t("el-dialog",{attrs:{title:"题库信息",visible:e.fromVisible,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"名称",prop:"gname"}},[t("el-input",{attrs:{placeholder:"名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"类型",prop:"score"}},[t("el-select",{staticStyle:{width:"100%","margin-right":"10px"},attrs:{placeholder:"请选择"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[t("el-option",{attrs:{value:"选择题",label:"选择题"}}),t("el-option",{attrs:{value:"判断题",label:"判断题"}})],1)],1),"选择题"==e.form.type?t("el-form-item",{attrs:{label:"A",prop:"optiona"}},[t("el-input",{attrs:{placeholder:"名称"},model:{value:e.form.optiona,callback:function(t){e.$set(e.form,"optiona",t)},expression:"form.optiona"}})],1):e._e(),"选择题"==e.form.type?t("el-form-item",{attrs:{label:"B",prop:"optionb"}},[t("el-input",{attrs:{placeholder:"名称"},model:{value:e.form.optionb,callback:function(t){e.$set(e.form,"optionb",t)},expression:"form.optionb"}})],1):e._e(),"选择题"==e.form.type?t("el-form-item",{attrs:{label:"C",prop:"optionc"}},[t("el-input",{attrs:{placeholder:"名称"},model:{value:e.form.optionc,callback:function(t){e.$set(e.form,"optionc",t)},expression:"form.optionc"}})],1):e._e(),t("el-form-item",{attrs:{label:"正确答案",prop:"rightreply"}},[t("el-input",{attrs:{placeholder:"正确答案"},model:{value:e.form.rightreply,callback:function(t){e.$set(e.form,"rightreply",t)},expression:"form.rightreply"}})],1),t("el-form-item",{attrs:{label:"所属题库",prop:"score"}},[t("el-select",{staticStyle:{width:"100%","margin-right":"10px"},attrs:{placeholder:"请选择"},model:{value:e.form.tikuid,callback:function(t){e.$set(e.form,"tikuid",t)},expression:"form.tikuid"}},e._l(e.tikulist,(function(e){return t("el-option",{attrs:{value:e.id,label:e.name}})})),1)],1),t("el-form-item",{attrs:{label:"是否重点题目",prop:"score"}},[t("el-select",{staticStyle:{width:"100%","margin-right":"10px"},attrs:{placeholder:"请选择"},model:{value:e.form.isim,callback:function(t){e.$set(e.form,"isim",t)},expression:"form.isim"}},[t("el-option",{attrs:{value:"是",label:"是"}}),t("el-option",{attrs:{value:"否",label:"否"}})],1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.fromVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)},i=[],r=a(18962),o={data(){return{fileList:[],teacherlist:[],tikulist:[],tableData:[],pageNum:1,pageSize:10,total:0,username:null,token:"",name:null,fromVisible:!1,avatar:"",queryform:{keyword:"",pageNum:1,pageSize:10},license:"",form:{avatar:"",license:""},user:{},rules:{cname:[{required:!0,message:"请输入名称",trigger:"blur"}]},ids:[],businessList:[],categoryList:[],hotellist:[],sjlist:[]}},mounted(){this.token=window.localStorage.getItem("token"),this.user=JSON.parse(window.localStorage.getItem("userinfo")),console.log(this.user),this.getlist(),this.getall()},methods:{shenhe(e){},async selectca(e){console.log(e);const t=await r.A.get("/hotal/typeByhotel?id="+e);console.log(t),this.categoryList=t.data},selectcaf(e){this.$forceUpdate()},handleFileSuccess(e){this.form.img=e.data},async getall(){const e=await r.A.get("/tiku/all");console.log(e),this.tikulist=e.data},del(e){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.get("/tiku/delete?id="+e);console.log(t),1==t.code&&(this.$message({type:"success",message:"删除成功!"}),this.getlist())})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},force(e){this.form.timeRange=e,this.$forceUpdate()},handleEdit(e){this.form=e,this.avatar=e.avatar,this.form.teacherid=e.teacherid,"ADMIN"==this.user.role&&this.getall(),this.fromVisible=!0},search(){this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},research(){this.queryform.keyword="",this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},async getlist(){const e=await r.A.get("/tiku/qlistim",{params:this.queryform});console.log(e),1==e.code&&(this.tableData=e.data.records,this.total=e.data.total)},add(){this.avatar="",this.license="",this.fileList=[],this.form={},this.fromVisible=!0},handleLicenseSuccess(e){},async save(){const e=await r.A.post("/tiku/savequestion",this.form);1==e.code&&(this.fromVisible=!1,this.$message.success("操作成功"),this.getlist())},handleCurrentChange(e){},handleAvatarSuccess(e){console.log(e),this.avatar=e.data,console.log(this.form.avatar)},handleAvatarSuccess1(e){this.license=e.data}}},l=o,n=a(81656),c=(0,n.A)(l,s,i,!1,null,"f9f871a6",null),d=c.exports},3780:function(e,t,a){a.d(t,{A:function(){return m}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"global1"},[t("div",{staticStyle:{"margin-bottom":"10px"}},[t("el-button",{attrs:{type:"primary",plain:""},on:{click:e.fbsp}},[e._v("新增")])],1),t("el-table",{attrs:{data:e.tableData,strip:""}},[t("el-table-column",{attrs:{type:"index",label:"序号",width:"70",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"name",label:"联系人"}}),t("el-table-column",{attrs:{prop:"addressname",label:"地址"}}),t("el-table-column",{attrs:{prop:"phone",label:"电话"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.del(a.row.id)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.queryform.pageNum,"page-sizes":[5,10,20],"page-size":e.queryform.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{visible:e.fromVisible,title:"地址信息",width:"40%"},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"联系人",prop:"name",required:""}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"地址",prop:"addressname",required:""}},[t("el-input",{model:{value:e.form.addressname,callback:function(t){e.$set(e.form,"addressname",t)},expression:"form.addressname"}})],1),t("el-form-item",{attrs:{label:"电话",prop:"phone",required:""}},[t("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.save()}}},[e._v("保存")])],1)],1)],1)],1)},i=[],r=a(18962),o=a(5507),l=a.n(o),n={data(){return{content:"",queryform:{pageNum:1,pageSize:10},total:0,fromVisible:!1,tableData:[],typelist:[],form:{},fromVisible1:!1}},mounted(){this.user=JSON.parse(window.localStorage.getItem("userinfo")),this.getall(),this.getlist()},methods:{chakan(e){this.content=e.detail,this.fromVisible1=!0},handleEdit(e){this.form=e,this.fromVisible=!0},handleCurrentChange(e){this.queryform.pageNum=e,this.getlist()},async save(){const e=await r.A.post("/address/add",this.form);console.log(e),this.fromVisible=!1,this.getlist()},async getall(){const e=await r.A.get("/type/getall");console.log(e),this.typelist=e.data},handleAvatarSuccesss(e){this.form.img=e.data},fbsp(){this.form={},this.fromVisible=!0},initE(){this.editor=new(l())("#e"),this.editor.create()},del(e){this.$confirm("是否确认退课?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.get("/address/delete?id="+e);console.log(t),1==t.code&&(this.$message({type:"success",message:"删除成功!"}),this.getlist())})).catch((()=>{this.$message({type:"info",message:"已取消"})}))},async getlist(){const e=await r.A.get("/address/list",{params:this.queryform});console.log(e),this.tableData=e.data.records,this.total=e.data.total}}},c=n,d=a(81656),u=(0,d.A)(c,s,i,!1,null,"3c8c2503",null),m=u.exports},32219:function(e,t,a){a.d(t,{A:function(){return m}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"global1"},[t("el-table",{attrs:{data:e.tableData,stripe:"",height:"300"}},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-table",{attrs:{data:a.row.detail,stripe:""}},[t("el-table-column",{attrs:{prop:"name",label:"名称"}}),t("el-table-column",{attrs:{prop:"avatar",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.avatar?t("el-image",{staticStyle:{width:"40px",height:"40px","border-radius":"50%"},attrs:{src:a.row.avatar,"preview-src-list":[a.row.avatar]}}):e._e()]}}],null,!0)}),t("el-table-column",{attrs:{prop:"price",label:"价格"}}),t("el-table-column",{attrs:{prop:"amount",label:"数量"}})],1)]}}])}),t("el-table-column",{attrs:{type:"index",label:"序号",width:"70",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"number",label:"订单编号"}}),t("el-table-column",{attrs:{prop:"price",label:"总价"}}),t("el-table-column",{attrs:{prop:"ordertime",label:"下单时间"}}),t("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",[e._v(e._s(a.row.status))])]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.del(a.row)}}},[e._v("删除")])]}}])})],1),t("el-dialog",{attrs:{visible:e.fromVisible,title:"地址信息",width:"40%"},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{attrs:{model:e.form}},[t("el-form-item",{attrs:{label:"联系人",prop:"name",required:""}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"地址",prop:"addressname",required:""}},[t("el-input",{model:{value:e.form.addressname,callback:function(t){e.$set(e.form,"addressname",t)},expression:"form.addressname"}})],1),t("el-form-item",{attrs:{label:"电话",prop:"phone",required:""}},[t("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.save()}}},[e._v("保存")])],1)],1)],1)],1)},i=[],r=a(18962),o=a(5507),l=a.n(o),n={data(){return{content:"",activeName:"first",queryform:{pageNum:1,pageSize:10},total:0,tableData1:[],fromVisible:!1,tableData:[],typelist:[],form:{},fromVisible1:!1}},mounted(){this.user=JSON.parse(window.localStorage.getItem("userinfo")),this.getlist()},methods:{chakan(e){this.content=e.detail,this.fromVisible1=!0},handleEdit(e){this.form=e,this.fromVisible=!0},handleCurrentChange(e){this.queryform.pageNum=e,this.getlist()},async save(){const e=await r.A.post("/address/add",this.form);console.log(e),this.fromVisible=!1,this.getlist()},async getall(){const e=await r.A.get("/type/getall");console.log(e),this.typelist=e.data},handleAvatarSuccesss(e){this.form.img=e.data},fbsp(){this.form={},this.fromVisible=!0},initE(){this.editor=new(l())("#e"),this.editor.create()},zhifu(e){this.$confirm("是否确认支付?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.post("/order/zhifu",{id:e.id,zt:"已支付"});console.log(t),1==t.code&&(this.$message({type:"success",message:"支付成功!"}),this.getlist())})).catch((()=>{this.$message({type:"info",message:"已取消"})}))},sh(e){this.$confirm("是否确认收货?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.post("/order/quxiao",{id:e.id,zt:"已收货"});console.log(t),1==t.code&&(this.$message({type:"success",message:"收货成功!"}),this.getlist())})).catch((()=>{this.$message({type:"info",message:"已取消"})}))},del(e){this.$confirm("是否确认取消?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.get("/guke/orderdelete?id="+e.id);console.log(t),1==t.code&&(this.$message({type:"success",message:"删除成功!"}),this.getlist())})).catch((()=>{this.$message({type:"info",message:"已取消"})}))},async getlist(){const e=await r.A.get("/guke/order/list");console.log(e),this.tableData=e.data}}},c=n,d=a(81656),u=(0,d.A)(c,s,i,!1,null,"4c1e03f7",null),m=u.exports},88433:function(e,t,a){a.d(t,{A:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",[t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.tableData,stripe:"",height:"300"}},[t("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-table",{attrs:{data:a.row.detail,stripe:""}},[t("el-table-column",{attrs:{prop:"name",label:"名称"}}),t("el-table-column",{attrs:{prop:"avatar",label:"头像"},scopedSlots:e._u([{key:"default",fn:function(a){return[a.row.avatar?t("el-image",{staticStyle:{width:"40px",height:"40px","border-radius":"50%"},attrs:{src:a.row.avatar,"preview-src-list":[a.row.avatar]}}):e._e()]}}],null,!0)}),t("el-table-column",{attrs:{prop:"price",label:"价格"}}),t("el-table-column",{attrs:{prop:"amount",label:"数量"}})],1)]}}])}),t("el-table-column",{attrs:{type:"index",label:"序号",width:"70",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"number",label:"订单编号"}}),t("el-table-column",{attrs:{prop:"price",label:"总价"}}),t("el-table-column",{attrs:{prop:"ordertime",label:"下单时间"}}),t("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",[e._v(e._s(a.row.status))])]}}])}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.del(a.row.id)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.queryform.pageNum,"page-sizes":[5,10,20],"page-size":e.queryform.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)]),t("el-dialog",{attrs:{title:"当前物流",visible:e.fromVisible,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"当前地址",prop:"intime"}},[t("el-input",{model:{value:e.form.dqdz,callback:function(t){e.$set(e.form,"dqdz",t)},expression:"form.dqdz"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.fromVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)},i=[],r=(a(98992),a(3949),a(18962)),o={data(){return{fileList:[],tableData:[],pageNum:1,pageSize:10,total:0,username:null,token:"",name:null,fromVisible:!1,avatar:"",queryform:{keyword:"",pageNum:1,pageSize:10},license:"",form:{avatar:"",license:""},user:{},rules:{cname:[{required:!0,message:"请输入名称",trigger:"blur"}]},ids:[],businessList:[],categoryList:[],roomlist:[],hotellist:[],sjlist:[]}},mounted(){this.token=window.localStorage.getItem("token"),this.user=JSON.parse(window.localStorage.getItem("userinfo")),this.getlist()},methods:{async fh(e){this.$confirm("是否确认发货?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.post("/order/quxiao",{id:e.id,zt:"待收货"});1==t.code&&(this.$message({type:"success",message:"发货成功!"}),this.getlist())})).catch((e=>{this.$message({type:"info",message:"已取消"})}))},async selectca(e){const t=await r.A.get("/hotal/orderall");this.categoryList=t.data},async selectcaf(e){this.categoryList.forEach((async(t,a)=>{if(t.id==e){this.form.outtime=this.categoryList[a].outtime,this.form.userid=this.categoryList[a].userid,this.form.hotelid=this.categoryList[a].hotelid,this.form.typeid=this.categoryList[a].typeid;const e=await r.A.get(`/hotal/roomByhotalId?hotelId=${this.categoryList[a].hotelid}&&typeId=${this.categoryList[a].typeid}`);this.roomlist=e.data,this.$forceUpdate()}}))},handleFileSuccess(e){this.form.img=e.data},async getall(){const e=await r.A.get("/hotal/all");this.hotellist=e.data},del(e){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.get("/admin/orderdelete?id="+e);1==t.code&&(this.$message({type:"success",message:"删除成功!"}),this.getlist())})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},force(e){this.form.timeRange=e,this.$forceUpdate()},handleEdit(e){this.form=e,this.fromVisible=!0},search(){this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},research(){this.queryform.keyword="",this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},async getlist(){const e=await r.A.get("/admin/order/list",{params:this.queryform});1==e.code&&(this.tableData=e.data.records,this.total=e.data.total)},add(){this.avatar="",this.license="",this.fileList=[],this.form={},this.fromVisible=!0},handleLicenseSuccess(e){},async save(){const e=await r.A.post("/order/quxiao",this.form);1==e.code&&(this.fromVisible=!1,this.$message.success("操作成功"),this.getlist())},handleCurrentChange(e){},handleAvatarSuccess(e){this.avatar=e.data},handleAvatarSuccess1(e){this.license=e.data}}},l=o,n=a(81656),c=(0,n.A)(l,s,i,!1,null,"7e71aadb",null),d=c.exports},87258:function(e,t,a){a.d(t,{A:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticStyle:{width:"50%"}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:e.user,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"原始密码",prop:"password"}},[t("el-input",{attrs:{"show-password":"",placeholder:"原始密码"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),t("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[t("el-input",{attrs:{"show-password":"",placeholder:"新密码"},model:{value:e.user.newPassword,callback:function(t){e.$set(e.user,"newPassword",t)},expression:"user.newPassword"}})],1),t("el-form-item",{attrs:{label:"确认新密码",prop:"confirmPassword"}},[t("el-input",{attrs:{"show-password":"",placeholder:"确认密码"},model:{value:e.user.confirmPassword,callback:function(t){e.$set(e.user,"confirmPassword",t)},expression:"user.confirmPassword"}})],1),t("div",{staticStyle:{"text-align":"center","margin-bottom":"20px"}},[t("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("确认修改")])],1)],1)],1)],1)},i=[],r=a(18962),o={name:"AdminPerson",data(){return{user:{}}},created(){},mounted(){this.user=JSON.parse(window.localStorage.getItem("userinfo"))},methods:{handleAvatarSuccess(e,t,a){this.$set(this.user,"avatar",e.data)},async update(){if(this.user.passnewPassword!==this.user.confirmPassword)this.$message.warning("新密码和确认密码不一样");else if("BUSINESS"==this.user.role){const e=await r.A.post("/Business/updatePassword",{id:this.user.id,username:this.user.username,password:this.user.newPassword});console.log(e),1==e.code&&this.$message.success(e.data)}},handleAvatarSuccess1(e,t,a){this.$set(this.user,"license",e.data)}}},l=o,n=a(81656),c=(0,n.A)(l,s,i,!1,null,null,null),d=c.exports},81166:function(e,t,a){a.d(t,{A:function(){return u}});var s=function(){var e=this,t=e._self._c;return t("div",[t("el-card",{staticClass:"mb"},[t("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"请输入关键词搜索"},model:{value:e.queryform.keyword,callback:function(t){e.$set(e.queryform,"keyword",t)},expression:"queryform.keyword"}}),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.search()}}},[e._v("查询")]),t("el-button",{attrs:{type:"info",plain:""},on:{click:function(t){return e.research()}}},[e._v("重置")]),t("el-button",{staticStyle:{float:"right"},attrs:{type:"warning",plain:""},on:{click:function(t){return e.add()}}},[e._v("新增")])],1),t("el-card",[t("div",{staticClass:"table"},[t("el-table",{attrs:{data:e.tableData,strip:""}},[t("el-table-column",{attrs:{prop:"id",label:"序号",width:"70",align:"center",sortable:""}}),t("el-table-column",{attrs:{prop:"name",label:"名称"}}),t("el-table-column",{attrs:{prop:"teacherName",label:"创建人"}}),t("el-table-column",{attrs:{label:"操作",align:"center",width:"350"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:function(t){return e.wtch(a.row.id)}}},[e._v("查看回答")]),t("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:function(t){return e.wtch1(a.row.id)}}},[e._v("评价")]),t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger",plain:""},on:{click:function(t){return e.del(a.row.id)}}},[e._v("删除")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"","current-page":e.queryform.pageNum,"page-sizes":[5,10,20],"page-size":e.queryform.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1)]),t("el-dialog",{attrs:{title:"回答信息",visible:e.fromVisible1,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible1=t}}},e._l(e.commentlist,(function(a){return t("div",{key:a.id,staticClass:"commentylist"},[t("div",{staticClass:"avatar"},[t("user-avatar",{attrs:{src:a.avatar||a.teacheravatar,size:"small",clickable:!1}})],1),t("div",{staticClass:"user"},[t("div",{staticClass:"username",staticStyle:{"margin-bottom":"10px"}},[e._v(e._s(null==a.username?a.teachername:a.username))]),t("div",{staticClass:"username"},[e._v(e._s(a.name))])]),t("div",{staticClass:"dianzan",staticStyle:{flex:"1","text-align":"right"}},[1==a.dianzan?t("i",{staticClass:"el-icon-star-off",staticStyle:{color:"blue"},on:{click:function(t){return e.changestar(a)}}}):e._e(),0==a.dianzan?t("i",{staticClass:"el-icon-star-off",on:{click:function(t){return e.changestar(a)}}}):e._e()])])})),0),t("el-dialog",{attrs:{title:"评价",visible:e.fromVisible2,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible2=t}}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"内容",prop:"name"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.fromVisible2=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save1}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"问答信息",visible:e.fromVisible,width:"40%","close-on-click-modal":!1,"destroy-on-close":""},on:{"update:visible":function(t){e.fromVisible=t}}},[t("el-form",{ref:"formRef",staticStyle:{"padding-right":"50px"},attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[t("el-form-item",{attrs:{label:"问题名称",prop:"gname"}},[t("el-input",{attrs:{placeholder:"名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"小组",prop:"gname"}},[t("el-select",{staticStyle:{width:"100%","margin-right":"10px"},attrs:{placeholder:"请选择"},model:{value:e.form.groupid,callback:function(t){e.$set(e.form,"groupid",t)},expression:"form.groupid"}},e._l(e.grouplist,(function(e){return t("el-option",{attrs:{value:e.id,label:e.name}})})),1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.fromVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确 定")])],1)],1)],1)},i=[],r=(a(98992),a(3949),a(18962)),o=a(92646),l={components:{UserAvatar:o.A},data(){return{fileList:[],teacherlist:[],tableData:[],pageNum:1,pageSize:10,total:0,username:null,tableData1:[],grouplist:[],token:"",name:null,fromVisible:!1,fromVisible1:!1,fromVisible2:!1,avatar:"",queryform:{keyword:"",pageNum:1,tid:0,pageSize:10},license:"",form:{avatar:"",license:""},user:{},commentlist:[],rules:{cname:[{required:!0,message:"请输入名称",trigger:"blur"}]},ids:[],businessList:[],categoryList:[],hotellist:[],sjlist:[]}},mounted(){this.token=window.localStorage.getItem("token"),this.user=JSON.parse(window.localStorage.getItem("userinfo")),console.log(this.user),this.getlist(),this.getall()},methods:{shenhe(e){},async changestar(e){e.dianzan=!e.dianzan,this.commentlist=JSON.parse(JSON.stringify(this.commentlist));const t=await r.A.post("/star/star",{aid:e.id,tid:this.user.id,qqid:this.qid});console.log(t)},async save1(){await r.A.post("/answer/add",{name:this.form.content,qid:this.qid,tid:this.user.id});this.fromVisible2=!1,this.$message.success("成功")},wtch1(e){this.qid=e,this.fromVisible2=!0},async wtch(e){this.qid=e;const t=await r.A.get("/answer/list?id="+e);console.log(t),this.commentlist=t.data,this.commentlist.forEach((e=>{e.dianzan=!1})),console.log(this.commentlist),this.fromVisible1=!0},selectcaf(e){this.$forceUpdate()},handleFileSuccess(e){this.form.img=e.data},async getall(){const e=await r.A.get("/group/all");console.log(e),this.grouplist=e.data},del1(e){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.get("/group/deleteusergroup?id="+e);console.log(t),1==t.code&&(this.$message({type:"success",message:"删除成功!"}),this.fromVisible1=!1)})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},del(e){this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await r.A.get("/group/qdelete?id="+e);console.log(t),1==t.code&&(this.$message({type:"success",message:"删除成功!"}),this.getlist())})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},force(e){this.form.timeRange=e,this.$forceUpdate()},handleEdit(e){this.form=e,this.avatar=e.avatar,this.form.teacherid=e.teacherid,"ADMIN"==this.user.role&&this.getall(),this.fromVisible=!0},search(){this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},research(){this.queryform.keyword="",this.queryform.pageNum=1,this.queryform.pageSize=10,this.getlist()},async getlist(){"TEACHER"==this.user.role&&(this.queryform.tid=this.user.id);const e=await r.A.get("/group/qlist",{params:this.queryform});console.log(e),1==e.code&&(this.tableData=e.data.records,this.total=e.data.total)},add(){this.avatar="",this.license="",this.fileList=[],this.form={},this.fromVisible=!0},handleLicenseSuccess(e){},async save(){this.form.avatar=this.avatar,"TEACHER"==this.user.role&&(this.form.tid=this.user.id);const e=await r.A.post("/group/addgroupquestion",this.form);1==e.code&&(this.fromVisible=!1,this.$message.success("操作成功"),this.getlist())},handleCurrentChange(e){},handleAvatarSuccess(e){console.log(e),this.avatar=e.data,console.log(this.form.avatar)},handleAvatarSuccess1(e){this.license=e.data}}},n=l,c=a(81656),d=(0,c.A)(n,s,i,!1,null,"75fda6ed",null),u=d.exports},49586:function(e,t,a){function s(e,t="YYYY-MM-DD HH:mm:ss"){if(!e)return"";const a=e instanceof Date?e:new Date(e);if(isNaN(a.getTime()))return"";const s=a.getFullYear(),i=String(a.getMonth()+1).padStart(2,"0"),r=String(a.getDate()).padStart(2,"0"),o=String(a.getHours()).padStart(2,"0"),l=String(a.getMinutes()).padStart(2,"0"),n=String(a.getSeconds()).padStart(2,"0");return t.replace("YYYY",s).replace("MM",i).replace("DD",r).replace("HH",o).replace("mm",l).replace("ss",n)}function i(e){return s(e,"YYYY-MM-DD")}function r(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const a=new Date,s=a.getTime()-t.getTime(),i=Math.floor(s/1e3),r=Math.floor(i/60),o=Math.floor(r/60),l=Math.floor(o/24),n=Math.floor(l/30),c=Math.floor(l/365);return i<60?"刚刚":r<60?`${r}分钟前`:o<24?`${o}小时前`:l<30?`${l}天前`:n<12?`${n}个月前`:`${c}年前`}function o(e,t=7){if(!e)return"";const a=e instanceof Date?e:new Date(e);if(isNaN(a.getTime()))return"";const i=new Date,o=i.getTime()-a.getTime(),l=Math.floor(o/864e5);return l<t?r(e):s(e,"YYYY-MM-DD HH:mm")}function l(e){if(!e)return!1;const t=e instanceof Date?e:new Date(e),a=new Date;return t.getFullYear()===a.getFullYear()&&t.getMonth()===a.getMonth()&&t.getDate()===a.getDate()}function n(e){if(!e)return!1;const t=e instanceof Date?e:new Date(e),a=new Date,s=new Date(a);return s.setDate(s.getDate()-1),t.getFullYear()===s.getFullYear()&&t.getMonth()===s.getMonth()&&t.getDate()===s.getDate()}a.d(t,{PA:function(){return n},Yq:function(){return i},cK:function(){return l},fU:function(){return s},fw:function(){return r},og:function(){return o}})},37620:function(e,t,a){function s(e){return e?/^https?:\/\//.test(e)?e:"https://orkj406039jmw6me.top/api/file/getImage/"+e:""}a.d(t,{VG:function(){return s}})},40981:function(e,t){const a=!1;class s{log(...e){}info(...e){}warn(...e){}error(...e){console.error(...e)}debug(...e){a&&console.debug(...e)}group(e){a&&console.group(e)}groupEnd(){a&&console.groupEnd()}table(e){a&&console.table(e)}}t.A=new s},14951:function(e,t,a){function s(e){if(!e)return"";const t=document.createElement("div");t.innerHTML=e;let a=t.textContent||t.innerText||"";return a=a.replace(/\s+/g," ").trim(),a}function i(e,t,a="..."){return e?e.length<=t?e:e.substring(0,t)+a:""}function r(e,t=100){const a=s(e);return i(a,t)}function o(e){if(!e)return"";const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,(e=>t[e]))}function l(e){return e?e.replace(/<[^>]*>/g,""):""}function n(e){if(!e||0===e)return"0 B";const t=["B","KB","MB","GB","TB"],a=1024,s=Math.floor(Math.log(e)/Math.log(a));return(e/Math.pow(a,s)).toFixed(2)+" "+t[s]}function c(e){return!e||!e.trim()}a.d(t,{AY:function(){return s},EJ:function(){return i},Im:function(){return c},QZ:function(){return l},UM:function(){return r},ZD:function(){return o},v7:function(){return n}})}}]);